# mach-lsp

A lightweight language-server prototype written in Mach. It currently handles a minimal subset of the Language Server Protocol for experimentation with the Mach toolchain.

## Prerequisites

- The Mach compiler (`cmach`) built from the sibling [`mach-c`](../mach-c) repository.
- The standard library sources available in [`mach-std`](../mach-std).

By default the build expects the directory layout used in this workspace:

```
../mach-c/bin/cmach
../mach-std/src
```

You can override these paths with the `CMACH` and `STD_SRC_DIR` variables when invoking `make`.

## Build

```bash
make
```

This compiles `src/main.mach` and produces `out/bin/mach-lsp`.

## Run

After building, start the language server directly:

```bash
make run
```

This executes `out/bin/mach-lsp` in the current terminal. Integrate it with your editor or client of choice by pointing to that binary.

## Cleaning

Remove generated binaries and intermediate artefacts:

```bash
make clean
```

## Customising paths

Example overriding the compiler path and standard library location:

```bash
make CMACH=$HOME/.local/bin/cmach STD_SRC_DIR=$HOME/dev/mach-std/src
```

## Project layout

- `src/`: Mach sources for the server.
- `out/bin/`: The compiled language server executable.
- `out/obj/`: Object files generated by the compiler.
- `out/`: Overall build root (safe to delete; recreated automatically).
- `mach.toml`: Project metadata for future tooling.
